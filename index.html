<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BWAM Banking</title>
    <link href="./dist/output.css" rel="stylesheet">
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>
<body class="bg-gray-light">
    <div id="root"></div>

    <script type="text/babel">
        // Create context
        const AppContext = React.createContext();

        // App Provider Component
        function AppProvider({ children }) {
            const [isAuthenticated, setIsAuthenticated] = React.useState(false);
            const [currentLanguage, setCurrentLanguage] = React.useState('en');
            const [currentView, setCurrentView] = React.useState('home');
            const [user, setUser] = React.useState(null);
            const [error, setError] = React.useState(null);

            const login = React.useCallback((email, password) => {
                // Simulate API call
                if (email && password) {
                    setUser({ email });
                    setIsAuthenticated(true);
                    setError(null);
                } else {
                    setError('Please enter both email and password');
                }
            }, []);

            const logout = React.useCallback(() => {
                setUser(null);
                setIsAuthenticated(false);
            }, []);

            const value = {
                isAuthenticated,
                currentLanguage,
                currentView,
                user,
                error,
                login,
                logout,
                setCurrentLanguage,
                setCurrentView
            };

            return (
                <AppContext.Provider value={value}>
                    {children}
                </AppContext.Provider>
            );
        }

        // Auth Hook
        function useAuth() {
            const context = React.useContext(AppContext);
            if (!context) {
                throw new Error('useAuth must be used within an AppProvider');
            }
            return context;
        }

        // Header Component
        function HeaderApp() {
            const { 
                isAuthenticated, 
                currentLanguage, 
                setCurrentLanguage,
                login,
                logout,
                error
            } = useAuth();
            const [email, setEmail] = React.useState('');
            const [password, setPassword] = React.useState('');

            const handleLogin = (e) => {
                e.preventDefault();
                login(email, password);
            };

            return (
                <header className="bg-white shadow-md">
                    <div className="container mx-auto px-4 py-4 flex justify-between items-center">
                        <div className="flex items-center">
                            <img src="./images/bwam-logo.jpg" alt="BWAM Logo" className="h-12 w-auto mr-4" />
                            <h1 className="text-2xl font-bold text-brand-red">BWAM Banking</h1>
                        </div>
                        <div className="flex items-center space-x-4">
                            <select 
                                value={currentLanguage}
                                onChange={(e) => setCurrentLanguage(e.target.value)}
                                className="border rounded px-2 py-1"
                            >
                                <option value="en">English</option>
                                <option value="de">Deutsch</option>
                            </select>
                            {!isAuthenticated ? (
                                <form onSubmit={handleLogin} className="flex items-center space-x-2">
                                    <input
                                        type="email"
                                        value={email}
                                        onChange={(e) => setEmail(e.target.value)}
                                        placeholder="Email"
                                        className="border rounded px-2 py-1"
                                    />
                                    <input
                                        type="password"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        placeholder="Password"
                                        className="border rounded px-2 py-1"
                                    />
                                    <button 
                                        type="submit"
                                        className="bg-brand-red text-white px-4 py-1 rounded hover:bg-brand-red-dark"
                                    >
                                        Login
                                    </button>
                                </form>
                            ) : (
                                <button 
                                    onClick={logout}
                                    className="bg-brand-red text-white px-4 py-1 rounded hover:bg-brand-red-dark"
                                >
                                    Logout
                                </button>
                            )}
                        </div>
                    </div>
                    {error && (
                        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded relative" role="alert">
                            <span className="block sm:inline">{error}</span>
                        </div>
                    )}
                </header>
            );
        }

        // Profile Section Component
        function ProfileSection() {
            const { user } = useAuth();
            const [profile, setProfile] = React.useState(null);
            const [loading, setLoading] = React.useState(true);

            React.useEffect(() => {
                if (user) {
                    // Simulate API call to fetch profile
                    setTimeout(() => {
                        setProfile({
                            name: 'John Doe',
                            accountNumber: '1234567890',
                            balance: 5000
                        });
                        setLoading(false);
                    }, 1000);
                }
            }, [user]);

            if (!user) return null;
            if (loading) return <div>Loading profile...</div>;

            return (
                <div className="container mx-auto px-4 py-8">
                    <div className="bg-white rounded-lg shadow-md p-6">
                        <h2 className="text-xl font-bold mb-4">Profile Information</h2>
                        <div className="space-y-2">
                            <p><strong>Name:</strong> {profile.name}</p>
                            <p><strong>Email:</strong> {user.email}</p>
                            <p><strong>Account Number:</strong> {profile.accountNumber}</p>
                            <p><strong>Balance:</strong> ${profile.balance}</p>
                        </div>
                    </div>
                </div>
            );
        }

        // Main App Component
        function App() {
            return (
                <AppProvider>
                    <div className="min-h-screen">
                        <HeaderApp />
                        <ProfileSection />
                    </div>
                </AppProvider>
            );
        }

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
